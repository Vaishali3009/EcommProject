package com.rbs.bdd.application.service;

import com.rbs.bdd.application.port.out.AccountValidationPort;
import com.rbs.bdd.generated.ValidateArrangementForPaymentRequest;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.ws.WebServiceMessage;

import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.mockito.Mockito.*;

class PaymentOrchestratorTest {

    private AccountValidationPort accountValidationPort;
    private PaymentOrchestrator paymentOrchestrator;

    @BeforeEach
    void setup() {
        accountValidationPort = mock(AccountValidationPort.class);
        paymentOrchestrator = new PaymentOrchestrator(accountValidationPort);
    }

    @Test
    void testValidateArrangementForPayment_shouldDelegateToAccountValidationPort() {
        // Arrange
        ValidateArrangementForPaymentRequest request = new ValidateArrangementForPaymentRequest();
        WebServiceMessage message = mock(WebServiceMessage.class);

        // Act
        paymentOrchestrator.validateArrangementForPayment(request, message);

        // Assert
        verify(accountValidationPort).validateSchema(request);
        verify(accountValidationPort).validateBusinessRules(request, message);
    }
}
